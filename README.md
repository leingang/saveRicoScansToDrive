# saveRicohScansToDrive

It started with a conversation between me and ChatGPT:

> Can you write a Google App Script to save all PDFs attached to emails coming from a specific address to a Google Drive folder?

What it generated didn't work, but I was able to modify it in a few places to
make it work.

## Installation and Usage

*This documentation is also autogenerated by ChatGPT and lightly edited.*

To use this script, follow these steps:

1. Open your Google Drive account.
2. Go to the Google Drive folder where you want to save the PDFs.
3. Click on "New" and select "Google Script".
4. Copy and paste the above script into the script editor.
5. Modify the `folderName` and `printerName` variables to suit your specific needs.
6. Click on "Run" and select "savePDFsToDrive".
7. Grant the necessary permissions to the script when prompted.
8. Wait for the script to finish running. The PDFs will be saved to the specified folder in your Google Drive.

## Automation

To run the script automatically every five minutes, you can create a time-driven trigger in Google Apps Script. Here are the steps to create the trigger:

1. Open your Google Apps Script project that contains the script you want to run.
2. Click on the "Triggers" icon in the left-hand menu (clock icon).
3. Click on the "Add Trigger" button in the bottom right-hand corner.
4. Set the following options:
    * Choose which function to run: `savePDFsToDrive`
    * Choose which deployment should run: **Head**
    * Select event source: **Time-driven**
    * Select type of time based trigger: **Minutes timer**
    * Set minutes interval: **Every 5 minutes**
    * Set failure notification setting: **Notify me immediately**
5. Click on the "Save" button.
6. Review and authorize the permissions required by the script when prompted.
7. Close the "Triggers" window.

Once the trigger is set up, the `savePDFsToDrive` function will be automatically executed every five minutes. You can modify the interval by editing the trigger you just created in the "Triggers" window.

## Changelog

### 2023-05-15

* Refactored to more idiomatic JavaScript (e.g., `filter` and `forEach` on arrays instead of `for` loops)

### 2023-05-14

* regular expression to read from multiple printers (WIP)
* refactored to make it easier to read

### 2023-05-12

* Now a GitHub repository

### 2023-05-08

* initial script
